# X-Downloader Chrome 插件

## 📖 简介

X-Downloader 是一个专为小红书设计的 Chrome 浏览器扩展，可以批量下载小红书用户的笔记内容，包括图片、视频和文本。

## ✨ 主要功能

### 🎯 核心功能
- **批量下载**: 支持批量下载用户的所有笔记
- **多种内容**: 支持下载图片、视频、文本内容
- **智能识别**: 自动识别页面中的笔记内容
- **进度显示**: 实时显示下载进度和统计信息
- **设置保存**: 自动保存用户设置，下次使用无需重新配置

### 🔧 技术特性
- **无需API**: 直接解析页面内容，无需调用官方API
- **反爬虫规避**: 运行在浏览器环境中，天然规避反爬虫检测
- **用户认证**: 利用用户已登录的账号和浏览器认证信息
- **动态加载**: 支持自动滚动加载更多内容

## 🚀 安装方法

### 方法一：开发者模式安装（推荐）

1. **下载插件文件**
   ```bash
   git clone https://github.com/your-repo/X-Downloader.git
   cd X-Downloader/chrome_extension
   ```

2. **打开Chrome扩展管理页面**
   - 在Chrome地址栏输入：`chrome://extensions/`
   - 或者点击菜单 → 更多工具 → 扩展程序

3. **启用开发者模式**
   - 在扩展管理页面右上角打开"开发者模式"开关

4. **加载插件**
   - 点击"加载已解压的扩展程序"
   - 选择 `chrome_extension` 文件夹
   - 插件安装完成！

### 方法二：打包安装

1. **打包插件**
   ```bash
   cd chrome_extension
   zip -r x-downloader.zip . -x "*.git*" "README.md"
   ```

2. **安装打包文件**
   - 将 `x-downloader.zip` 拖拽到 `chrome://extensions/` 页面
   - 或者解压后使用"加载已解压的扩展程序"

## 📱 使用方法

### 1. 准备工作
- 确保已登录小红书账号
- 打开要下载的用户主页页面

### 2. 使用插件
1. **点击插件图标**
   - 在Chrome工具栏找到 X-Downloader 图标
   - 点击打开设置面板

2. **配置下载选项**
   - **最大下载数量**: 设置要下载的笔记数量（1-100）
   - **保存文件夹**: 设置下载文件的保存文件夹名称
   - **下载内容**: 选择要下载的内容类型
     - ✅ 下载图片
     - ✅ 下载视频
     - ✅ 保存文本
   - **自动滚动**: 是否自动滚动加载更多内容

3. **开始下载**
   - 点击"🚀 开始下载"按钮
   - 插件会自动分析页面内容并开始下载
   - 可以随时点击"⏹️ 停止下载"中断操作

### 3. 查看结果
- 下载的文件会保存到浏览器的默认下载目录
- 每个笔记会创建一个独立文件夹
- 文件夹包含笔记信息、图片、视频等文件

## 📁 文件结构

```
chrome_extension/
├── manifest.json          # 插件配置文件
├── popup.html            # 弹出窗口界面
├── popup.js              # 弹出窗口逻辑
├── content.js            # 内容脚本（页面交互）
├── background.js         # 后台脚本（服务工作者）
├── icons/                # 图标文件
│   ├── icon16.png
│   ├── icon48.png
│   └── icon128.png
└── README.md             # 说明文档
```

## ⚙️ 配置说明

### manifest.json
- **权限配置**: 包含必要的浏览器权限
- **内容脚本**: 自动注入到小红书页面
- **后台脚本**: 处理下载和通知功能

### 主要权限
- `activeTab`: 访问当前标签页
- `storage`: 保存用户设置
- `downloads`: 下载文件
- `scripting`: 执行脚本
- `tabs`: 管理标签页
- `webNavigation`: 监听页面导航

## 🔧 高级功能

### 1. 自动滚动加载
- 插件会自动滚动页面加载更多内容
- 可以通过设置控制是否启用此功能
- 支持设置最大滚动次数避免无限加载

### 2. 智能内容识别
- 多种选择器策略识别笔记内容
- 支持从页面文本中提取笔记信息
- 自动过滤无效内容和重复内容

### 3. 下载管理
- 实时显示下载进度
- 支持暂停和恢复下载
- 自动处理下载错误和重试

### 4. 设置持久化
- 自动保存用户设置到本地存储
- 下次使用时自动加载上次的设置
- 支持重置为默认设置

## 🛠️ 开发说明

### 技术栈
- **前端**: HTML5, CSS3, JavaScript (ES6+)
- **浏览器API**: Chrome Extensions API
- **存储**: Chrome Storage API
- **下载**: Chrome Downloads API

### 核心类
- `XHSPopup`: 弹出窗口管理
- `XHSContentScript`: 页面内容处理
- `XHSBackground`: 后台服务管理

### 消息通信
- Popup ↔ Content Script: 通过 `chrome.tabs.sendMessage`
- Content Script ↔ Background: 通过 `chrome.runtime.sendMessage`
- 支持异步消息处理和错误处理

## 🐛 故障排除

### 常见问题

1. **插件无法安装**
   - 确保Chrome版本 >= 88
   - 检查是否启用了开发者模式
   - 确认文件结构完整

2. **无法识别笔记内容**
   - 确保在小红书用户主页页面
   - 检查页面是否完全加载
   - 尝试刷新页面后重试

3. **下载失败**
   - 检查网络连接
   - 确认有足够的磁盘空间
   - 检查浏览器下载设置

4. **权限问题**
   - 确认插件有必要的权限
   - 重新安装插件
   - 检查Chrome安全设置

### 调试方法

1. **查看控制台日志**
   - 右键点击插件图标 → 检查弹出内容
   - 在页面按F12打开开发者工具
   - 查看Console标签页的日志信息

2. **检查扩展管理页面**
   - 访问 `chrome://extensions/`
   - 查看插件状态和错误信息
   - 点击"重新加载"按钮

3. **重置插件设置**
   - 在扩展管理页面点击"详情"
   - 点击"清除数据"重置设置

## 📄 许可证

本项目仅供学习和个人使用，请遵守小红书的使用条款和版权规定。

## 🤝 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目！

## 📞 支持

如果遇到问题或有建议，请通过以下方式联系：
- 提交 GitHub Issue
- 发送邮件到：your-email@example.com

---

**版本**: 2.0.0  
**最后更新**: 2025-07-26  
**兼容性**: Chrome 88+ 
# 📥 小红书笔记下载功能指南

## 🎯 功能概述

X-Downloader 插件现在支持两种下载模式：

1. **用户主页批量下载**: 在用户profile页面批量下载所有笔记
2. **单篇笔记完整下载**: 在笔记详情页面下载单篇笔记的完整内容

## 🔄 两种下载模式对比

| 功能 | 用户主页批量下载 | 单篇笔记完整下载 |
|------|------------------|------------------|
| **适用页面** | 用户profile页面 | 笔记详情页面 |
| **图片数量** | 仅封面图片 | 完整图片列表 |
| **视频数量** | 可能缺失 | 完整视频列表 |
| **下载方式** | 插件弹窗配置 | 页面内下载按钮 |
| **使用场景** | 批量收集用户笔记 | 下载单篇完整内容 |

## 📋 使用方法

### 方法一：用户主页批量下载

1. **打开用户主页**
   - 访问小红书用户profile页面
   - 例如：`https://www.xiaohongshu.com/user/profile/xxx`

2. **使用插件下载**
   - 点击浏览器工具栏中的插件图标
   - 配置下载选项（图片、视频、文本）
   - 点击"开始下载"

3. **限制说明**
   - 只能下载封面图片
   - 无法获取笔记正文中的完整图片列表
   - 适合快速浏览和收集

### 方法二：单篇笔记完整下载 ⭐ 推荐

1. **打开笔记详情页**
   - 点击任意笔记进入详情页面
   - 例如：`https://www.xiaohongshu.com/exploration/xxx`

2. **使用下载按钮**
   - 页面右上角会出现"📥 下载笔记"按钮
   - 点击按钮开始下载
   - 自动下载完整图片和视频

3. **优势特点**
   - ✅ 下载笔记正文中的所有图片
   - ✅ 下载完整视频内容
   - ✅ 获取完整文本信息
   - ✅ 一键下载，无需配置

## 🎨 下载按钮样式

下载按钮会显示在笔记详情页面的右上角：

```
┌─────────────────────────────────┐
│                                 │
│                    📥 下载笔记  │
│                                 │
└─────────────────────────────────┘
```

- **位置**: 固定右上角
- **样式**: 渐变紫色背景，白色文字
- **交互**: 鼠标悬停有缩放效果
- **层级**: 最高层级，不会被遮挡

## 📁 下载文件结构

### 单篇笔记下载结构
```
小红书笔记/
└── 笔记标题/
    ├── note_info.txt          # 笔记信息
    ├── image_1.jpg           # 图片1
    ├── image_2.jpg           # 图片2
    ├── image_3.jpg           # 图片3
    └── video_1.mp4           # 视频1
```

### 批量下载结构
```
小红书笔记/
├── 用户昵称/
│   ├── 笔记1/
│   │   ├── note_info.txt
│   │   └── cover_image.jpg   # 仅封面图片
│   ├── 笔记2/
│   │   ├── note_info.txt
│   │   └── cover_image.jpg
│   └── ...
```

## 🔧 技术实现

### 页面检测
插件会自动检测当前页面类型：

- **用户主页**: `url.includes('/user/profile/')`
- **笔记详情**: `url.includes('/exploration/') || url.includes('/discovery/')`

### 图片提取策略

#### 用户主页（批量下载）
```javascript
// 只能获取封面图片
const imgElements = element.querySelectorAll('img');
// 过滤掉头像、图标等
```

#### 笔记详情页（完整下载）
```javascript
// 获取所有图片
const imgSelectors = [
    'img[src*="xhs.cn"]',
    'img[src*="xiaohongshu.com"]',
    'img[src*="sns-img"]',
    'img[src*="image"]',
    'img'
];
// 去重并获取高清版本
```

## 🚀 使用建议

### 推荐工作流程

1. **浏览用户主页**
   - 使用批量下载快速收集感兴趣的笔记
   - 查看封面和基本信息

2. **深入下载**
   - 点击感兴趣的笔记进入详情页
   - 使用下载按钮获取完整内容
   - 下载所有图片和视频

### 最佳实践

- ✅ **批量下载**: 用于快速收集和筛选
- ✅ **单篇下载**: 用于获取完整内容
- ✅ **组合使用**: 先批量后单篇，效率最高

## 🔍 故障排除

### 下载按钮不显示
1. 确认在笔记详情页面
2. 刷新页面重新加载
3. 检查插件是否启用

### 图片下载失败
1. 检查网络连接
2. 确认图片URL是否有效
3. 查看浏览器控制台错误信息

### 视频无法下载
1. 确认视频是否已加载
2. 检查视频URL格式
3. 尝试刷新页面

## 📞 技术支持

如果遇到问题：
1. 查看浏览器控制台日志
2. 确认页面类型是否正确
3. 检查插件权限设置
4. 提供详细的错误信息

---

**版本**: 2.1.0  
**更新**: 2024-07-26  
**新增功能**: 单篇笔记完整下载 